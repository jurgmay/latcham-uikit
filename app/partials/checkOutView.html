<!-- *** checkOutView *** -->

<!-- main-container start -->
<!-- ==================== -->
<section uk-height-viewport="expand: true" class="uk-section uk-background-muted">

	<div class="uk-container">

		<!-- page-title start -->
		<!-- ================ -->
		<div class="uk-text-center">
			<h1 class="uk-heading uk-text-uppercase">Delivery</h1>
			<div class="uk-divider-small"></div>
		</div>
		<!-- page-title end -->

		<div class="uk-card uk-card-small uk-card-default">
			<div class="uk-card-body">

				<loadingindicator ng-show="displayLoadingIndicator" title="{{'Please wait while we update your order' | r | xlat}}" />

				<div ng-hide="shipaddressform || (shipaddresses.length == 0 && user.Permissions.contains('CreateShipToAddress'))">
					<div ng-show="(cart_order.$error.required.length + cart_billing.$error.required.length + cart_shipping.$error.required.length + cart_billing.$error.paymentMethod.length) > 0">
						<ul class="uk-list uk-alert uk-alert-warning">
							<li class="uk-text-center">
								<span class="uk-badge uk-padding-small">
									<span class="uk-padding-small uk-padding-remove-left" uk-icon="icon: warning"></span>
									{{cart_order.$error.required.length + cart_billing.$error.required.length + cart_shipping.$error.required.length + cart_billing.$error.paymentMethod.length}}
								</span>
							</li>

							<li class="uk-text-center">
								<ul ng-class="{'one': errorSection == 'open', 'two': errorSection == '' }">
									<li ng-if="cart_order.orderid.$invalid">{{'Please enter an ' + ('order' | r) + ' ' + ('ID' | r) | xlat}}</li>
									<li ng-if="cart_order.costcenter.$invalid">{{'Please enter an ' + ('Cost' | r) + ' ' + ('Center' | r) | xlat}}</li>
									<li ng-repeat="field in currentOrder.OrderFields">
										<span ng-if="field.Required == true && field.Value == '' || field.Required == true && field.Value == null">Please select or enter {{field.Label}}</span>
									</li>
									<li ng-if="cart_shipping.shippingAddress.$invalid">{{'Please choose a ' + ('Shipping' | rl) + ' ' + ('Address' | rl) | xlat}}</li>
									<li ng-if="cart_shipping.shippingAddressLineItem.$invalid">{{'Please choose a ' + ('Shipping' | rl) + ' ' + ('Address' | rl) | xlat}}</li>
									<li ng-if="cart_shipping.shipMethod.$invalid">{{'Please choose a ' + ('Shipping' | rl) + ' ' + ('Method' | rl) | xlat}}</li>
									<li ng-if="cart_billing.billingAddress.$invalid">{{'Please choose a ' + ('Billing' | rl) + ' ' + ('Address' | rl) | xlat}}</li>
									<li ng-if="cart_billing.billingFirstName.$invalid">{{'Please enter a ' + ('Billing' | rl) + ' ' + ('First Name' | rl) | xlat}}</li>
									<li ng-if="cart_billing.billingLastName.$invalid">{{'Please enter a ' + ('Billing' | rl) + ' ' + ('Last Name' | rl) | xlat}}</li>
									<li ng-if="cart_billing.$error.paymentMethod">{{'Please choose a valid ' + ('Payment' | rl) + ' ' + ('Method' | rl) | xlat}}</li>
									<li ng-if="!user.Permissions.contains('CreateBillToAddress') && billaddresses.length == 0">
										{{'You have not been granted permission to create a ' + ('Billing' | r) + ' ' + ('Address' | r) + ', and no ' + ('Billing' | r) + ' ' + ('Addresses' | r) + ' have been assigned to you. Therefore, you are not allowed to place this ' + ('Order' | r) + ' at this time' | xlat}}
									</li>
									<li ng-if="!user.Permissions.contains('CreateShipToAddress') && shipaddresses.length == 0">
										{{'You have not been granted permission to create a ' + ('Shipping' | r) + ' ' + ('Address' | r) + ', and no ' + ('Shipping' | r) + ' ' + ('Addresses' | r) + ' have been assigned to you. Therefore, you are not allowed to place this ' + ('Order' | r) + ' at this time' | xlat}}
								</ul>
							</li>

							<li class="uk-text-center" ng-show="(cart_order.$error.required.length + cart_billing.$error.required.length + cart_shipping.$error.required.length + cart_billing.$error.paymentMethod.length) > 1">
								<a href>
									<i class="fa fa-caret-down" ng-click="errorSection = 'open'" ng-hide="errorSection == 'open'"></i>
									<i class="fa fa-caret-up" ng-click="errorSection = ''" ng-show="errorSection == 'open'"></i>
								</a>
							</li>

						</ul>
					</div>
				</div>

				<div ng-show="currentOrder && currentOrder.isEditable" ng-click="showSuccessAlert = false">

					<div uk-grid class="uk-flex-center">
						<!-- Hide if the New Address block is being displayed. -->
						<div class="uk-width-1-2" ng-hide="shipaddressform || (shipaddresses.length == 0 && user.Permissions.contains('CreateShipToAddress'))">
							<orderdetails ng-show="hasOrderConfig" />
						</div>

						<div class="uk-width-1-2">
							<ordershipping />
							<!-- <orderapprovals ng-show="currentOrder.Approvals" /> -->
							<!-- <orderbilling ng-show="currentOrder.BillingEnabled" /> -->
						</div>
					</div>

					<!-- Hide if the New Address block is being displayed -->
					<div ng-hide="shipaddressform || (shipaddresses.length == 0 && user.Permissions.contains('CreateShipToAddress'))">
						<div class="view-response-message alert-success text-center" alert-show="actionMessage">
							<p>{{actionMessage | r | xlat}}</p>
						</div>
						<div class="view-response-message alert-danger text-center" alert-show="errorMessage">
							<p>{{errorMessage | r | xlat}}</p>
						</div>
						<div class="view-response-message alert-danger text-center" alert-show="couponError">
							<p>{{couponError | r | xlat}}</p>
						</div>

						<div class="uk-alert-primary uk-text-large uk-text-center" uk-alert>
							<p>ORDER TOTAL: <strong>{{currentOrder.Total | culturecurrency}}</strong></p>
						</div>

						<orderbuttons view="checkout" continue="true"></orderbuttons>

					</div>
				</div>
			</div>
		</div>
	</div>
</section>
